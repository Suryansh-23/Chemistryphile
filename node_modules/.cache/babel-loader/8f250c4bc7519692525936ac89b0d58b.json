{"ast":null,"code":"var fs = require('fs');\n\nvar path = require('path');\n\nvar URL = require('url');\n\nvar toFileUrl = require('./jsdom/utils').toFileUrl;\n\nvar defineGetter = require('./jsdom/utils').defineGetter;\n\nvar defineSetter = require('./jsdom/utils').defineSetter;\n\nvar features = require('./jsdom/browser/documentfeatures');\n\nvar dom = require('./jsdom/living');\n\nvar browserAugmentation = require('./jsdom/browser/index').browserAugmentation;\n\nvar domToHtml = require('./jsdom/browser/domtohtml').domToHtml;\n\nvar VirtualConsole = require('./jsdom/virtual-console');\n\nvar request = function () {\n  // lazy loading request\n  request = require('request');\n  return request.apply(undefined, arguments);\n};\n\nexports.getVirtualConsole = function (window) {\n  return window._virtualConsole;\n};\n\nexports.debugMode = false; // Proxy feature functions to features module.\n\n['availableDocumentFeatures', 'defaultDocumentFeatures', 'applyDocumentFeatures'].forEach(function (propName) {\n  defineGetter(exports, propName, function () {\n    return features[propName];\n  });\n  defineSetter(exports, propName, function (val) {\n    return features[propName] = val;\n  });\n});\n\nexports.jsdom = function (html, options) {\n  if (options === undefined) {\n    options = {};\n  }\n\n  if (options.parsingMode === undefined || options.parsingMode === 'auto') {\n    options.parsingMode = 'html';\n  }\n\n  var browser = browserAugmentation(dom, options);\n  var doc = new browser.HTMLDocument(options);\n\n  if (options.created) {\n    options.created(null, doc.parentWindow);\n  }\n\n  features.applyDocumentFeatures(doc, options.features);\n\n  if (html === undefined) {\n    html = '';\n  }\n\n  html = String(html);\n  doc.write(html);\n\n  if (doc.close && !options.deferClose) {\n    doc.close();\n  }\n\n  return doc;\n};\n\nexports.jQueryify = exports.jsdom.jQueryify = function (window, jqueryUrl, callback) {\n  if (!window || !window.document) {\n    return;\n  }\n\n  var features = window.document.implementation._features;\n\n  window.document.implementation._addFeature('FetchExternalResources', ['script']);\n\n  window.document.implementation._addFeature('ProcessExternalResources', ['script']);\n\n  window.document.implementation._addFeature('MutationEvents', ['2.0']);\n\n  var scriptEl = window.document.createElement('script');\n  scriptEl.className = 'jsdom';\n  scriptEl.src = jqueryUrl;\n\n  scriptEl.onload = scriptEl.onerror = function () {\n    window.document.implementation._features = features;\n\n    if (callback) {\n      callback(window, window.jQuery);\n    }\n  };\n\n  window.document.body.appendChild(scriptEl);\n};\n\nexports.env = exports.jsdom.env = function () {\n  var config = getConfigFromArguments(arguments);\n\n  if (config.file) {\n    fs.readFile(config.file, 'utf-8', function (err, text) {\n      if (err) {\n        if (config.created) {\n          config.created(err);\n        }\n\n        if (config.done) {\n          config.done([err]);\n        }\n\n        return;\n      }\n\n      setParsingModeFromExtension(config, config.file);\n      config.html = text;\n      processHTML(config);\n    });\n  } else if (config.html !== undefined) {\n    processHTML(config);\n  } else if (config.url) {\n    handleUrl(config);\n  } else if (config.somethingToAutodetect !== undefined) {\n    var url = URL.parse(config.somethingToAutodetect);\n\n    if (url.protocol && url.hostname) {\n      config.url = config.somethingToAutodetect;\n      handleUrl(config.somethingToAutodetect);\n    } else {\n      fs.readFile(config.somethingToAutodetect, 'utf-8', function (err, text) {\n        if (err) {\n          // the toString() test is because in Node.js, there is no proper code for this.\n          // This is fixed in io.js: https://github.com/iojs/io.js/issues/517 so:\n          // TODO: remove when we start requiring io.js\n          if (err.code === 'ENOENT' || err.code === 'ENAMETOOLONG' || err.toString() == 'Error: Path must be a string without null bytes.') {\n            config.html = config.somethingToAutodetect;\n            processHTML(config);\n          } else {\n            if (config.created) {\n              config.created(err);\n            }\n\n            if (config.done) {\n              config.done([err]);\n            }\n          }\n        } else {\n          setParsingModeFromExtension(config, config.somethingToAutodetect);\n          config.html = text;\n          config.url = toFileUrl(config.somethingToAutodetect);\n          processHTML(config);\n        }\n      });\n    }\n  }\n\n  function handleUrl() {\n    var options = {\n      uri: config.url,\n      encoding: config.encoding || 'utf8',\n      headers: config.headers || {},\n      proxy: config.proxy || null,\n      jar: config.jar !== undefined ? config.jar : true\n    };\n    request(options, function (err, res, responseText) {\n      if (err) {\n        if (config.created) {\n          config.created(err);\n        }\n\n        if (config.done) {\n          config.done([err]);\n        }\n\n        return;\n      } // The use of `res.request.uri.href` ensures that `window.location.href`\n      // is updated when `request` follows redirects.\n\n\n      config.html = responseText;\n      config.url = res.request.uri.href;\n\n      if (config.parsingMode === \"auto\" && (res.headers[\"content-type\"] === \"application/xml\" || res.headers[\"content-type\"] === \"text/xml\" || res.headers[\"content-type\"] === \"application/xhtml+xml\")) {\n        config.parsingMode = \"xml\";\n      }\n\n      processHTML(config);\n    });\n  }\n};\n\nexports.serializeDocument = function (doc) {\n  return domToHtml(doc, true);\n};\n\nfunction processHTML(config) {\n  var options = {\n    features: config.features,\n    url: config.url,\n    parser: config.parser,\n    parsingMode: config.parsingMode,\n    created: config.created,\n    resourceLoader: config.resourceLoader\n  };\n\n  if (config.document) {\n    options.referrer = config.document.referrer;\n    options.cookie = config.document.cookie;\n    options.cookieDomain = config.document.cookieDomain;\n  }\n\n  var window = exports.jsdom(config.html, options).parentWindow;\n  var features = JSON.parse(JSON.stringify(window.document.implementation._features));\n  var docsLoaded = 0;\n  var totalDocs = config.scripts.length + config.src.length;\n  var readyState = null;\n  var errors = [];\n\n  if (!window || !window.document) {\n    if (config.created) {\n      config.created(new Error('JSDOM: a window object could not be created.'));\n    }\n\n    if (config.done) {\n      config.done([new Error('JSDOM: a window object could not be created.')]);\n    }\n\n    return;\n  }\n\n  window.document.implementation._addFeature('FetchExternalResources', ['script']);\n\n  window.document.implementation._addFeature('ProcessExternalResources', ['script']);\n\n  window.document.implementation._addFeature('MutationEvents', ['2.0']);\n\n  function scriptComplete() {\n    docsLoaded++;\n\n    if (docsLoaded >= totalDocs) {\n      window.document.implementation._features = features;\n      errors = errors.concat(window.document.errors || []);\n\n      if (errors.length === 0) {\n        errors = null;\n      }\n\n      process.nextTick(function () {\n        if (config.loaded) {\n          config.loaded(errors, window);\n        }\n\n        if (config.done) {\n          config.done(errors, window);\n        }\n      });\n    }\n  }\n\n  function handleScriptError(e) {\n    if (!errors) {\n      errors = [];\n    }\n\n    errors.push(e.error || e.message); // nextTick so that an exception within scriptComplete won't cause\n    // another script onerror (which would be an infinite loop)\n\n    process.nextTick(scriptComplete);\n  }\n\n  if (config.scripts.length > 0 || config.src.length > 0) {\n    config.scripts.forEach(function (scriptSrc) {\n      var script = window.document.createElement('script');\n      script.className = 'jsdom';\n      script.onload = scriptComplete;\n      script.onerror = handleScriptError;\n      script.src = scriptSrc;\n\n      try {\n        // protect against invalid dom\n        // ex: http://www.google.com/foo#bar\n        window.document.documentElement.appendChild(script);\n      } catch (e) {\n        handleScriptError(e);\n      }\n    });\n    config.src.forEach(function (scriptText) {\n      var script = window.document.createElement('script');\n      script.onload = scriptComplete;\n      script.onerror = handleScriptError;\n      script.text = scriptText;\n      window.document.documentElement.appendChild(script);\n      window.document.documentElement.removeChild(script);\n    });\n  } else {\n    if (window.document.readyState === 'complete') {\n      scriptComplete();\n    } else {\n      window.addEventListener('load', function () {\n        scriptComplete();\n      });\n    }\n  }\n}\n\nfunction getConfigFromArguments(args, callback) {\n  var config = {};\n\n  if (typeof args[0] === 'object') {\n    var configToClone = args[0];\n    Object.keys(configToClone).forEach(function (key) {\n      config[key] = configToClone[key];\n    });\n  } else {\n    var stringToAutodetect = null;\n    Array.prototype.forEach.call(args, function (arg) {\n      switch (typeof arg) {\n        case 'string':\n          config.somethingToAutodetect = arg;\n          break;\n\n        case 'function':\n          config.done = arg;\n          break;\n\n        case 'object':\n          if (Array.isArray(arg)) {\n            config.scripts = arg;\n          } else {\n            extend(config, arg);\n          }\n\n          break;\n      }\n    });\n  }\n\n  if (!config.done && !config.created && !config.loaded) {\n    throw new Error('Must pass a \"created\", \"loaded\", \"done\" option or a callback to jsdom.env.');\n  }\n\n  if (config.somethingToAutodetect === undefined && config.html === undefined && !config.file && !config.url) {\n    throw new Error('Must pass a \"html\", \"file\", or \"url\" option, or a string, to jsdom.env');\n  }\n\n  config.scripts = ensureArray(config.scripts);\n  config.src = ensureArray(config.src);\n  config.parsingMode = config.parsingMode || \"auto\";\n  config.features = config.features || {\n    FetchExternalResources: false,\n    ProcessExternalResources: false,\n    SkipExternalResources: false\n  };\n\n  if (!config.url && config.file) {\n    config.url = toFileUrl(config.file);\n  }\n\n  return config;\n}\n\nfunction ensureArray(value) {\n  var array = value || [];\n\n  if (typeof array === 'string') {\n    array = [array];\n  }\n\n  return array;\n}\n\nfunction extend(config, overrides) {\n  Object.keys(overrides).forEach(function (key) {\n    config[key] = overrides[key];\n  });\n}\n\nfunction setParsingModeFromExtension(config, filename) {\n  if (config.parsingMode === \"auto\") {\n    var ext = path.extname(filename);\n\n    if (ext === \".xhtml\" || ext === \".xml\") {\n      config.parsingMode = \"xml\";\n    }\n  }\n}","map":{"version":3,"sources":["F:/JavaScript/Projects/chemistryphile/node_modules/jsdom-no-contextify/lib/jsdom.js"],"names":["fs","require","path","URL","toFileUrl","defineGetter","defineSetter","features","dom","browserAugmentation","domToHtml","VirtualConsole","request","apply","undefined","arguments","exports","getVirtualConsole","window","_virtualConsole","debugMode","forEach","propName","val","jsdom","html","options","parsingMode","browser","doc","HTMLDocument","created","parentWindow","applyDocumentFeatures","String","write","close","deferClose","jQueryify","jqueryUrl","callback","document","implementation","_features","_addFeature","scriptEl","createElement","className","src","onload","onerror","jQuery","body","appendChild","env","config","getConfigFromArguments","file","readFile","err","text","done","setParsingModeFromExtension","processHTML","url","handleUrl","somethingToAutodetect","parse","protocol","hostname","code","toString","uri","encoding","headers","proxy","jar","res","responseText","href","serializeDocument","parser","resourceLoader","referrer","cookie","cookieDomain","JSON","stringify","docsLoaded","totalDocs","scripts","length","readyState","errors","Error","scriptComplete","concat","process","nextTick","loaded","handleScriptError","e","push","error","message","scriptSrc","script","documentElement","scriptText","removeChild","addEventListener","args","configToClone","Object","keys","key","stringToAutodetect","Array","prototype","call","arg","isArray","extend","ensureArray","FetchExternalResources","ProcessExternalResources","SkipExternalResources","value","array","overrides","filename","ext","extname"],"mappings":"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","sourcesContent":["var fs = require('fs');\nvar path = require('path');\nvar URL = require('url');\n\nvar toFileUrl = require('./jsdom/utils').toFileUrl;\nvar defineGetter = require('./jsdom/utils').defineGetter;\nvar defineSetter = require('./jsdom/utils').defineSetter;\nvar features = require('./jsdom/browser/documentfeatures');\nvar dom = require('./jsdom/living');\nvar browserAugmentation = require('./jsdom/browser/index').browserAugmentation;\nvar domToHtml = require('./jsdom/browser/domtohtml').domToHtml;\nvar VirtualConsole = require('./jsdom/virtual-console');\n\nvar request = function() { // lazy loading request\n  request = require('request');\n  return request.apply(undefined, arguments);\n}\n\nexports.getVirtualConsole = function (window) {\n  return window._virtualConsole;\n};\nexports.debugMode = false;\n\n// Proxy feature functions to features module.\n['availableDocumentFeatures',\n 'defaultDocumentFeatures',\n 'applyDocumentFeatures'].forEach(function (propName) {\n  defineGetter(exports, propName, function () {\n    return features[propName];\n  });\n  defineSetter(exports, propName, function (val) {\n    return features[propName] = val;\n  });\n});\n\nexports.jsdom = function (html, options) {\n  if (options === undefined) {\n    options = {};\n  }\n  if (options.parsingMode === undefined || options.parsingMode === 'auto') {\n    options.parsingMode = 'html';\n  }\n\n  var browser = browserAugmentation(dom, options);\n  var doc = new browser.HTMLDocument(options);\n\n  if (options.created) {\n    options.created(null, doc.parentWindow);\n  }\n\n  features.applyDocumentFeatures(doc, options.features);\n\n  if (html === undefined) {\n    html = '';\n  }\n  html = String(html);\n  doc.write(html);\n\n  if (doc.close && !options.deferClose) {\n    doc.close();\n  }\n\n  return doc;\n};\n\nexports.jQueryify = exports.jsdom.jQueryify = function (window, jqueryUrl, callback) {\n  if (!window || !window.document) {\n    return;\n  }\n\n  var features = window.document.implementation._features;\n  window.document.implementation._addFeature('FetchExternalResources', ['script']);\n  window.document.implementation._addFeature('ProcessExternalResources', ['script']);\n  window.document.implementation._addFeature('MutationEvents', ['2.0']);\n\n  var scriptEl = window.document.createElement('script');\n  scriptEl.className = 'jsdom';\n  scriptEl.src = jqueryUrl;\n  scriptEl.onload = scriptEl.onerror = function () {\n    window.document.implementation._features = features;\n\n    if (callback) {\n      callback(window, window.jQuery);\n    }\n  };\n\n  window.document.body.appendChild(scriptEl);\n};\n\nexports.env = exports.jsdom.env = function () {\n  var config = getConfigFromArguments(arguments);\n\n  if (config.file) {\n    fs.readFile(config.file, 'utf-8', function (err, text) {\n      if (err) {\n        if (config.created) {\n          config.created(err);\n        }\n        if (config.done) {\n          config.done([err]);\n        }\n        return;\n      }\n\n      setParsingModeFromExtension(config, config.file);\n\n      config.html = text;\n      processHTML(config);\n    });\n  } else if (config.html !== undefined) {\n    processHTML(config);\n  } else if (config.url) {\n    handleUrl(config);\n  } else if (config.somethingToAutodetect !== undefined) {\n    var url = URL.parse(config.somethingToAutodetect);\n    if (url.protocol && url.hostname) {\n      config.url = config.somethingToAutodetect;\n      handleUrl(config.somethingToAutodetect);\n    } else {\n      fs.readFile(config.somethingToAutodetect, 'utf-8', function (err, text) {\n        if (err) {\n          // the toString() test is because in Node.js, there is no proper code for this.\n          // This is fixed in io.js: https://github.com/iojs/io.js/issues/517 so:\n          // TODO: remove when we start requiring io.js\n          if (err.code === 'ENOENT' || err.code === 'ENAMETOOLONG'\n          \t|| (err.toString() == 'Error: Path must be a string without null bytes.')\n          ) {\n            config.html = config.somethingToAutodetect;\n            processHTML(config);\n          } else {\n            if (config.created) {\n              config.created(err);\n            }\n            if (config.done) {\n              config.done([err]);\n            }\n          }\n        } else {\n          setParsingModeFromExtension(config, config.somethingToAutodetect);\n\n          config.html = text;\n          config.url = toFileUrl(config.somethingToAutodetect);\n          processHTML(config);\n        }\n      });\n    }\n  }\n\n  function handleUrl() {\n    var options = {\n      uri: config.url,\n      encoding: config.encoding || 'utf8',\n      headers: config.headers || {},\n      proxy: config.proxy || null,\n      jar: config.jar !== undefined ? config.jar : true\n    };\n\n    request(options, function (err, res, responseText) {\n      if (err) {\n        if (config.created) {\n          config.created(err);\n        }\n        if (config.done) {\n          config.done([err]);\n        }\n        return;\n      }\n\n      // The use of `res.request.uri.href` ensures that `window.location.href`\n      // is updated when `request` follows redirects.\n      config.html = responseText;\n      config.url = res.request.uri.href;\n\n      if (config.parsingMode === \"auto\" && (\n        res.headers[\"content-type\"] === \"application/xml\" ||\n        res.headers[\"content-type\"] === \"text/xml\" ||\n        res.headers[\"content-type\"] === \"application/xhtml+xml\")) {\n        config.parsingMode = \"xml\";\n      }\n\n      processHTML(config);\n    });\n  }\n};\n\nexports.serializeDocument = function (doc) {\n  return domToHtml(doc, true);\n};\n\nfunction processHTML(config) {\n  var options = {\n    features: config.features,\n    url: config.url,\n    parser: config.parser,\n    parsingMode: config.parsingMode,\n    created: config.created,\n    resourceLoader: config.resourceLoader\n  };\n\n  if (config.document) {\n    options.referrer = config.document.referrer;\n    options.cookie = config.document.cookie;\n    options.cookieDomain = config.document.cookieDomain;\n  }\n\n  var window = exports.jsdom(config.html, options).parentWindow;\n  var features = JSON.parse(JSON.stringify(window.document.implementation._features));\n\n  var docsLoaded = 0;\n  var totalDocs = config.scripts.length + config.src.length;\n  var readyState = null;\n  var errors = [];\n\n  if (!window || !window.document) {\n    if (config.created) {\n      config.created(new Error('JSDOM: a window object could not be created.'));\n    }\n    if (config.done) {\n      config.done([new Error('JSDOM: a window object could not be created.')]);\n    }\n    return;\n  }\n\n  window.document.implementation._addFeature('FetchExternalResources', ['script']);\n  window.document.implementation._addFeature('ProcessExternalResources', ['script']);\n  window.document.implementation._addFeature('MutationEvents', ['2.0']);\n\n  function scriptComplete() {\n    docsLoaded++;\n\n    if (docsLoaded >= totalDocs) {\n      window.document.implementation._features = features;\n\n      errors = errors.concat(window.document.errors || []);\n      if (errors.length === 0) {\n        errors = null;\n      }\n\n      process.nextTick(function() {\n        if (config.loaded) {\n          config.loaded(errors, window);\n        }\n        if (config.done) {\n          config.done(errors, window);\n        }\n      });\n    }\n  }\n\n  function handleScriptError(e) {\n    if (!errors) {\n      errors = [];\n    }\n    errors.push(e.error || e.message);\n\n    // nextTick so that an exception within scriptComplete won't cause\n    // another script onerror (which would be an infinite loop)\n    process.nextTick(scriptComplete);\n  }\n\n  if (config.scripts.length > 0 || config.src.length > 0) {\n    config.scripts.forEach(function (scriptSrc) {\n      var script = window.document.createElement('script');\n      script.className = 'jsdom';\n      script.onload = scriptComplete;\n      script.onerror = handleScriptError;\n      script.src = scriptSrc;\n\n      try {\n        // protect against invalid dom\n        // ex: http://www.google.com/foo#bar\n        window.document.documentElement.appendChild(script);\n      } catch (e) {\n        handleScriptError(e);\n      }\n    });\n\n    config.src.forEach(function (scriptText) {\n      var script = window.document.createElement('script');\n      script.onload = scriptComplete;\n      script.onerror = handleScriptError;\n      script.text = scriptText;\n\n      window.document.documentElement.appendChild(script);\n      window.document.documentElement.removeChild(script);\n    });\n  } else {\n    if (window.document.readyState === 'complete') {\n      scriptComplete();\n    } else {\n      window.addEventListener('load', function() {\n        scriptComplete();\n      });\n    }\n  }\n}\n\nfunction getConfigFromArguments(args, callback) {\n  var config = {};\n  if (typeof args[0] === 'object') {\n    var configToClone = args[0];\n    Object.keys(configToClone).forEach(function (key) {\n      config[key] = configToClone[key];\n    });\n  } else {\n    var stringToAutodetect = null;\n\n    Array.prototype.forEach.call(args, function (arg) {\n      switch (typeof arg) {\n        case 'string':\n          config.somethingToAutodetect = arg;\n          break;\n        case 'function':\n          config.done = arg;\n          break;\n        case 'object':\n          if (Array.isArray(arg)) {\n            config.scripts = arg;\n          } else {\n            extend(config, arg);\n          }\n          break;\n      }\n    });\n  }\n\n  if (!config.done && !config.created && !config.loaded) {\n    throw new Error('Must pass a \"created\", \"loaded\", \"done\" option or a callback to jsdom.env.');\n  }\n\n  if (config.somethingToAutodetect === undefined &&\n      config.html === undefined && !config.file && !config.url) {\n    throw new Error('Must pass a \"html\", \"file\", or \"url\" option, or a string, to jsdom.env');\n  }\n\n  config.scripts = ensureArray(config.scripts);\n  config.src = ensureArray(config.src);\n  config.parsingMode = config.parsingMode || \"auto\";\n\n  config.features = config.features || {\n    FetchExternalResources: false,\n    ProcessExternalResources: false,\n    SkipExternalResources: false\n  };\n\n  if (!config.url && config.file) {\n    config.url = toFileUrl(config.file);\n  }\n\n  return config;\n}\n\nfunction ensureArray(value) {\n  var array = value || [];\n  if (typeof array === 'string') {\n    array = [array];\n  }\n  return array;\n}\n\nfunction extend(config, overrides) {\n  Object.keys(overrides).forEach(function (key) {\n    config[key] = overrides[key];\n  });\n}\n\nfunction setParsingModeFromExtension(config, filename) {\n  if (config.parsingMode === \"auto\") {\n    var ext = path.extname(filename);\n    if (ext === \".xhtml\" || ext === \".xml\") {\n      config.parsingMode = \"xml\";\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"script"}