{"ast":null,"code":"'use strict';\n\nvar Tokenizer = require('../tokenization/tokenizer'),\n    HTML = require('./html'); //Aliases\n\n\nvar $ = HTML.TAG_NAMES,\n    NS = HTML.NAMESPACES,\n    ATTRS = HTML.ATTRS; //MIME types\n\nvar MIME_TYPES = {\n  TEXT_HTML: 'text/html',\n  APPLICATION_XML: 'application/xhtml+xml'\n}; //Attributes\n\nvar DEFINITION_URL_ATTR = 'definitionurl',\n    ADJUSTED_DEFINITION_URL_ATTR = 'definitionURL',\n    SVG_ATTRS_ADJUSTMENT_MAP = {\n  'attributename': 'attributeName',\n  'attributetype': 'attributeType',\n  'basefrequency': 'baseFrequency',\n  'baseprofile': 'baseProfile',\n  'calcmode': 'calcMode',\n  'clippathunits': 'clipPathUnits',\n  'contentscripttype': 'contentScriptType',\n  'contentstyletype': 'contentStyleType',\n  'diffuseconstant': 'diffuseConstant',\n  'edgemode': 'edgeMode',\n  'externalresourcesrequired': 'externalResourcesRequired',\n  'filterres': 'filterRes',\n  'filterunits': 'filterUnits',\n  'glyphref': 'glyphRef',\n  'gradienttransform': 'gradientTransform',\n  'gradientunits': 'gradientUnits',\n  'kernelmatrix': 'kernelMatrix',\n  'kernelunitlength': 'kernelUnitLength',\n  'keypoints': 'keyPoints',\n  'keysplines': 'keySplines',\n  'keytimes': 'keyTimes',\n  'lengthadjust': 'lengthAdjust',\n  'limitingconeangle': 'limitingConeAngle',\n  'markerheight': 'markerHeight',\n  'markerunits': 'markerUnits',\n  'markerwidth': 'markerWidth',\n  'maskcontentunits': 'maskContentUnits',\n  'maskunits': 'maskUnits',\n  'numoctaves': 'numOctaves',\n  'pathlength': 'pathLength',\n  'patterncontentunits': 'patternContentUnits',\n  'patterntransform': 'patternTransform',\n  'patternunits': 'patternUnits',\n  'pointsatx': 'pointsAtX',\n  'pointsaty': 'pointsAtY',\n  'pointsatz': 'pointsAtZ',\n  'preservealpha': 'preserveAlpha',\n  'preserveaspectratio': 'preserveAspectRatio',\n  'primitiveunits': 'primitiveUnits',\n  'refx': 'refX',\n  'refy': 'refY',\n  'repeatcount': 'repeatCount',\n  'repeatdur': 'repeatDur',\n  'requiredextensions': 'requiredExtensions',\n  'requiredfeatures': 'requiredFeatures',\n  'specularconstant': 'specularConstant',\n  'specularexponent': 'specularExponent',\n  'spreadmethod': 'spreadMethod',\n  'startoffset': 'startOffset',\n  'stddeviation': 'stdDeviation',\n  'stitchtiles': 'stitchTiles',\n  'surfacescale': 'surfaceScale',\n  'systemlanguage': 'systemLanguage',\n  'tablevalues': 'tableValues',\n  'targetx': 'targetX',\n  'targety': 'targetY',\n  'textlength': 'textLength',\n  'viewbox': 'viewBox',\n  'viewtarget': 'viewTarget',\n  'xchannelselector': 'xChannelSelector',\n  'ychannelselector': 'yChannelSelector',\n  'zoomandpan': 'zoomAndPan'\n},\n    XML_ATTRS_ADJUSTMENT_MAP = {\n  'xlink:actuate': {\n    prefix: 'xlink',\n    name: 'actuate',\n    namespace: NS.XLINK\n  },\n  'xlink:arcrole': {\n    prefix: 'xlink',\n    name: 'arcrole',\n    namespace: NS.XLINK\n  },\n  'xlink:href': {\n    prefix: 'xlink',\n    name: 'href',\n    namespace: NS.XLINK\n  },\n  'xlink:role': {\n    prefix: 'xlink',\n    name: 'role',\n    namespace: NS.XLINK\n  },\n  'xlink:show': {\n    prefix: 'xlink',\n    name: 'show',\n    namespace: NS.XLINK\n  },\n  'xlink:title': {\n    prefix: 'xlink',\n    name: 'title',\n    namespace: NS.XLINK\n  },\n  'xlink:type': {\n    prefix: 'xlink',\n    name: 'type',\n    namespace: NS.XLINK\n  },\n  'xml:base': {\n    prefix: 'xml',\n    name: 'base',\n    namespace: NS.XML\n  },\n  'xml:lang': {\n    prefix: 'xml',\n    name: 'lang',\n    namespace: NS.XML\n  },\n  'xml:space': {\n    prefix: 'xml',\n    name: 'space',\n    namespace: NS.XML\n  },\n  'xmlns': {\n    prefix: '',\n    name: 'xmlns',\n    namespace: NS.XMLNS\n  },\n  'xmlns:xlink': {\n    prefix: 'xmlns',\n    name: 'xlink',\n    namespace: NS.XMLNS\n  }\n}; //SVG tag names adjustment map\n\nvar SVG_TAG_NAMES_ADJUSTMENT_MAP = {\n  'altglyph': 'altGlyph',\n  'altglyphdef': 'altGlyphDef',\n  'altglyphitem': 'altGlyphItem',\n  'animatecolor': 'animateColor',\n  'animatemotion': 'animateMotion',\n  'animatetransform': 'animateTransform',\n  'clippath': 'clipPath',\n  'feblend': 'feBlend',\n  'fecolormatrix': 'feColorMatrix',\n  'fecomponenttransfer': 'feComponentTransfer',\n  'fecomposite': 'feComposite',\n  'feconvolvematrix': 'feConvolveMatrix',\n  'fediffuselighting': 'feDiffuseLighting',\n  'fedisplacementmap': 'feDisplacementMap',\n  'fedistantlight': 'feDistantLight',\n  'feflood': 'feFlood',\n  'fefunca': 'feFuncA',\n  'fefuncb': 'feFuncB',\n  'fefuncg': 'feFuncG',\n  'fefuncr': 'feFuncR',\n  'fegaussianblur': 'feGaussianBlur',\n  'feimage': 'feImage',\n  'femerge': 'feMerge',\n  'femergenode': 'feMergeNode',\n  'femorphology': 'feMorphology',\n  'feoffset': 'feOffset',\n  'fepointlight': 'fePointLight',\n  'fespecularlighting': 'feSpecularLighting',\n  'fespotlight': 'feSpotLight',\n  'fetile': 'feTile',\n  'feturbulence': 'feTurbulence',\n  'foreignobject': 'foreignObject',\n  'glyphref': 'glyphRef',\n  'lineargradient': 'linearGradient',\n  'radialgradient': 'radialGradient',\n  'textpath': 'textPath'\n}; //Tags that causes exit from foreign content\n\nvar EXITS_FOREIGN_CONTENT = {};\nEXITS_FOREIGN_CONTENT[$.B] = true;\nEXITS_FOREIGN_CONTENT[$.BIG] = true;\nEXITS_FOREIGN_CONTENT[$.BLOCKQUOTE] = true;\nEXITS_FOREIGN_CONTENT[$.BODY] = true;\nEXITS_FOREIGN_CONTENT[$.BR] = true;\nEXITS_FOREIGN_CONTENT[$.CENTER] = true;\nEXITS_FOREIGN_CONTENT[$.CODE] = true;\nEXITS_FOREIGN_CONTENT[$.DD] = true;\nEXITS_FOREIGN_CONTENT[$.DIV] = true;\nEXITS_FOREIGN_CONTENT[$.DL] = true;\nEXITS_FOREIGN_CONTENT[$.DT] = true;\nEXITS_FOREIGN_CONTENT[$.EM] = true;\nEXITS_FOREIGN_CONTENT[$.EMBED] = true;\nEXITS_FOREIGN_CONTENT[$.H1] = true;\nEXITS_FOREIGN_CONTENT[$.H2] = true;\nEXITS_FOREIGN_CONTENT[$.H3] = true;\nEXITS_FOREIGN_CONTENT[$.H4] = true;\nEXITS_FOREIGN_CONTENT[$.H5] = true;\nEXITS_FOREIGN_CONTENT[$.H6] = true;\nEXITS_FOREIGN_CONTENT[$.HEAD] = true;\nEXITS_FOREIGN_CONTENT[$.HR] = true;\nEXITS_FOREIGN_CONTENT[$.I] = true;\nEXITS_FOREIGN_CONTENT[$.IMG] = true;\nEXITS_FOREIGN_CONTENT[$.LI] = true;\nEXITS_FOREIGN_CONTENT[$.LISTING] = true;\nEXITS_FOREIGN_CONTENT[$.MENU] = true;\nEXITS_FOREIGN_CONTENT[$.META] = true;\nEXITS_FOREIGN_CONTENT[$.NOBR] = true;\nEXITS_FOREIGN_CONTENT[$.OL] = true;\nEXITS_FOREIGN_CONTENT[$.P] = true;\nEXITS_FOREIGN_CONTENT[$.PRE] = true;\nEXITS_FOREIGN_CONTENT[$.RUBY] = true;\nEXITS_FOREIGN_CONTENT[$.S] = true;\nEXITS_FOREIGN_CONTENT[$.SMALL] = true;\nEXITS_FOREIGN_CONTENT[$.SPAN] = true;\nEXITS_FOREIGN_CONTENT[$.STRONG] = true;\nEXITS_FOREIGN_CONTENT[$.STRIKE] = true;\nEXITS_FOREIGN_CONTENT[$.SUB] = true;\nEXITS_FOREIGN_CONTENT[$.SUP] = true;\nEXITS_FOREIGN_CONTENT[$.TABLE] = true;\nEXITS_FOREIGN_CONTENT[$.TT] = true;\nEXITS_FOREIGN_CONTENT[$.U] = true;\nEXITS_FOREIGN_CONTENT[$.UL] = true;\nEXITS_FOREIGN_CONTENT[$.VAR] = true; //Check exit from foreign content\n\nexports.causesExit = function (startTagToken) {\n  var tn = startTagToken.tagName;\n\n  if (tn === $.FONT && (Tokenizer.getTokenAttr(startTagToken, ATTRS.COLOR) !== null || Tokenizer.getTokenAttr(startTagToken, ATTRS.SIZE) !== null || Tokenizer.getTokenAttr(startTagToken, ATTRS.FACE) !== null)) {\n    return true;\n  }\n\n  return EXITS_FOREIGN_CONTENT[tn];\n}; //Token adjustments\n\n\nexports.adjustTokenMathMLAttrs = function (token) {\n  for (var i = 0; i < token.attrs.length; i++) {\n    if (token.attrs[i].name === DEFINITION_URL_ATTR) {\n      token.attrs[i].name = ADJUSTED_DEFINITION_URL_ATTR;\n      break;\n    }\n  }\n};\n\nexports.adjustTokenSVGAttrs = function (token) {\n  for (var i = 0; i < token.attrs.length; i++) {\n    var adjustedAttrName = SVG_ATTRS_ADJUSTMENT_MAP[token.attrs[i].name];\n    if (adjustedAttrName) token.attrs[i].name = adjustedAttrName;\n  }\n};\n\nexports.adjustTokenXMLAttrs = function (token) {\n  for (var i = 0; i < token.attrs.length; i++) {\n    var adjustedAttrEntry = XML_ATTRS_ADJUSTMENT_MAP[token.attrs[i].name];\n\n    if (adjustedAttrEntry) {\n      token.attrs[i].prefix = adjustedAttrEntry.prefix;\n      token.attrs[i].name = adjustedAttrEntry.name;\n      token.attrs[i].namespace = adjustedAttrEntry.namespace;\n    }\n  }\n};\n\nexports.adjustTokenSVGTagName = function (token) {\n  var adjustedTagName = SVG_TAG_NAMES_ADJUSTMENT_MAP[token.tagName];\n  if (adjustedTagName) token.tagName = adjustedTagName;\n}; //Integration points\n\n\nexports.isMathMLTextIntegrationPoint = function (tn, ns) {\n  return ns === NS.MATHML && (tn === $.MI || tn === $.MO || tn === $.MN || tn === $.MS || tn === $.MTEXT);\n};\n\nexports.isHtmlIntegrationPoint = function (tn, ns, attrs) {\n  if (ns === NS.MATHML && tn === $.ANNOTATION_XML) {\n    for (var i = 0; i < attrs.length; i++) {\n      if (attrs[i].name === ATTRS.ENCODING) {\n        var value = attrs[i].value.toLowerCase();\n        return value === MIME_TYPES.TEXT_HTML || value === MIME_TYPES.APPLICATION_XML;\n      }\n    }\n  }\n\n  return ns === NS.SVG && (tn === $.FOREIGN_OBJECT || tn === $.DESC || tn === $.TITLE);\n};","map":{"version":3,"sources":["F:/JavaScript/Projects/chemistryphile/node_modules/jsdom-no-contextify/node_modules/parse5/lib/common/foreign_content.js"],"names":["Tokenizer","require","HTML","$","TAG_NAMES","NS","NAMESPACES","ATTRS","MIME_TYPES","TEXT_HTML","APPLICATION_XML","DEFINITION_URL_ATTR","ADJUSTED_DEFINITION_URL_ATTR","SVG_ATTRS_ADJUSTMENT_MAP","XML_ATTRS_ADJUSTMENT_MAP","prefix","name","namespace","XLINK","XML","XMLNS","SVG_TAG_NAMES_ADJUSTMENT_MAP","EXITS_FOREIGN_CONTENT","B","BIG","BLOCKQUOTE","BODY","BR","CENTER","CODE","DD","DIV","DL","DT","EM","EMBED","H1","H2","H3","H4","H5","H6","HEAD","HR","I","IMG","LI","LISTING","MENU","META","NOBR","OL","P","PRE","RUBY","S","SMALL","SPAN","STRONG","STRIKE","SUB","SUP","TABLE","TT","U","UL","VAR","exports","causesExit","startTagToken","tn","tagName","FONT","getTokenAttr","COLOR","SIZE","FACE","adjustTokenMathMLAttrs","token","i","attrs","length","adjustTokenSVGAttrs","adjustedAttrName","adjustTokenXMLAttrs","adjustedAttrEntry","adjustTokenSVGTagName","adjustedTagName","isMathMLTextIntegrationPoint","ns","MATHML","MI","MO","MN","MS","MTEXT","isHtmlIntegrationPoint","ANNOTATION_XML","ENCODING","value","toLowerCase","SVG","FOREIGN_OBJECT","DESC","TITLE"],"mappings":"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","sourcesContent":["'use strict';\r\n\r\nvar Tokenizer = require('../tokenization/tokenizer'),\r\n    HTML = require('./html');\r\n\r\n//Aliases\r\nvar $ = HTML.TAG_NAMES,\r\n    NS = HTML.NAMESPACES,\r\n    ATTRS = HTML.ATTRS;\r\n\r\n\r\n//MIME types\r\nvar MIME_TYPES = {\r\n    TEXT_HTML: 'text/html',\r\n    APPLICATION_XML: 'application/xhtml+xml'\r\n};\r\n\r\n//Attributes\r\nvar DEFINITION_URL_ATTR = 'definitionurl',\r\n    ADJUSTED_DEFINITION_URL_ATTR = 'definitionURL',\r\n    SVG_ATTRS_ADJUSTMENT_MAP = {\r\n        'attributename': 'attributeName',\r\n        'attributetype': 'attributeType',\r\n        'basefrequency': 'baseFrequency',\r\n        'baseprofile': 'baseProfile',\r\n        'calcmode': 'calcMode',\r\n        'clippathunits': 'clipPathUnits',\r\n        'contentscripttype': 'contentScriptType',\r\n        'contentstyletype': 'contentStyleType',\r\n        'diffuseconstant': 'diffuseConstant',\r\n        'edgemode': 'edgeMode',\r\n        'externalresourcesrequired': 'externalResourcesRequired',\r\n        'filterres': 'filterRes',\r\n        'filterunits': 'filterUnits',\r\n        'glyphref': 'glyphRef',\r\n        'gradienttransform': 'gradientTransform',\r\n        'gradientunits': 'gradientUnits',\r\n        'kernelmatrix': 'kernelMatrix',\r\n        'kernelunitlength': 'kernelUnitLength',\r\n        'keypoints': 'keyPoints',\r\n        'keysplines': 'keySplines',\r\n        'keytimes': 'keyTimes',\r\n        'lengthadjust': 'lengthAdjust',\r\n        'limitingconeangle': 'limitingConeAngle',\r\n        'markerheight': 'markerHeight',\r\n        'markerunits': 'markerUnits',\r\n        'markerwidth': 'markerWidth',\r\n        'maskcontentunits': 'maskContentUnits',\r\n        'maskunits': 'maskUnits',\r\n        'numoctaves': 'numOctaves',\r\n        'pathlength': 'pathLength',\r\n        'patterncontentunits': 'patternContentUnits',\r\n        'patterntransform': 'patternTransform',\r\n        'patternunits': 'patternUnits',\r\n        'pointsatx': 'pointsAtX',\r\n        'pointsaty': 'pointsAtY',\r\n        'pointsatz': 'pointsAtZ',\r\n        'preservealpha': 'preserveAlpha',\r\n        'preserveaspectratio': 'preserveAspectRatio',\r\n        'primitiveunits': 'primitiveUnits',\r\n        'refx': 'refX',\r\n        'refy': 'refY',\r\n        'repeatcount': 'repeatCount',\r\n        'repeatdur': 'repeatDur',\r\n        'requiredextensions': 'requiredExtensions',\r\n        'requiredfeatures': 'requiredFeatures',\r\n        'specularconstant': 'specularConstant',\r\n        'specularexponent': 'specularExponent',\r\n        'spreadmethod': 'spreadMethod',\r\n        'startoffset': 'startOffset',\r\n        'stddeviation': 'stdDeviation',\r\n        'stitchtiles': 'stitchTiles',\r\n        'surfacescale': 'surfaceScale',\r\n        'systemlanguage': 'systemLanguage',\r\n        'tablevalues': 'tableValues',\r\n        'targetx': 'targetX',\r\n        'targety': 'targetY',\r\n        'textlength': 'textLength',\r\n        'viewbox': 'viewBox',\r\n        'viewtarget': 'viewTarget',\r\n        'xchannelselector': 'xChannelSelector',\r\n        'ychannelselector': 'yChannelSelector',\r\n        'zoomandpan': 'zoomAndPan'\r\n    },\r\n    XML_ATTRS_ADJUSTMENT_MAP = {\r\n        'xlink:actuate': {prefix: 'xlink', name: 'actuate', namespace: NS.XLINK},\r\n        'xlink:arcrole': {prefix: 'xlink', name: 'arcrole', namespace: NS.XLINK},\r\n        'xlink:href': {prefix: 'xlink', name: 'href', namespace: NS.XLINK},\r\n        'xlink:role': {prefix: 'xlink', name: 'role', namespace: NS.XLINK},\r\n        'xlink:show': {prefix: 'xlink', name: 'show', namespace: NS.XLINK},\r\n        'xlink:title': {prefix: 'xlink', name: 'title', namespace: NS.XLINK},\r\n        'xlink:type': {prefix: 'xlink', name: 'type', namespace: NS.XLINK},\r\n        'xml:base': {prefix: 'xml', name: 'base', namespace: NS.XML},\r\n        'xml:lang': {prefix: 'xml', name: 'lang', namespace: NS.XML},\r\n        'xml:space': {prefix: 'xml', name: 'space', namespace: NS.XML},\r\n        'xmlns': {prefix: '', name: 'xmlns', namespace: NS.XMLNS},\r\n        'xmlns:xlink': {prefix: 'xmlns', name: 'xlink', namespace: NS.XMLNS}\r\n\r\n    };\r\n\r\n//SVG tag names adjustment map\r\nvar SVG_TAG_NAMES_ADJUSTMENT_MAP = {\r\n    'altglyph': 'altGlyph',\r\n    'altglyphdef': 'altGlyphDef',\r\n    'altglyphitem': 'altGlyphItem',\r\n    'animatecolor': 'animateColor',\r\n    'animatemotion': 'animateMotion',\r\n    'animatetransform': 'animateTransform',\r\n    'clippath': 'clipPath',\r\n    'feblend': 'feBlend',\r\n    'fecolormatrix': 'feColorMatrix',\r\n    'fecomponenttransfer': 'feComponentTransfer',\r\n    'fecomposite': 'feComposite',\r\n    'feconvolvematrix': 'feConvolveMatrix',\r\n    'fediffuselighting': 'feDiffuseLighting',\r\n    'fedisplacementmap': 'feDisplacementMap',\r\n    'fedistantlight': 'feDistantLight',\r\n    'feflood': 'feFlood',\r\n    'fefunca': 'feFuncA',\r\n    'fefuncb': 'feFuncB',\r\n    'fefuncg': 'feFuncG',\r\n    'fefuncr': 'feFuncR',\r\n    'fegaussianblur': 'feGaussianBlur',\r\n    'feimage': 'feImage',\r\n    'femerge': 'feMerge',\r\n    'femergenode': 'feMergeNode',\r\n    'femorphology': 'feMorphology',\r\n    'feoffset': 'feOffset',\r\n    'fepointlight': 'fePointLight',\r\n    'fespecularlighting': 'feSpecularLighting',\r\n    'fespotlight': 'feSpotLight',\r\n    'fetile': 'feTile',\r\n    'feturbulence': 'feTurbulence',\r\n    'foreignobject': 'foreignObject',\r\n    'glyphref': 'glyphRef',\r\n    'lineargradient': 'linearGradient',\r\n    'radialgradient': 'radialGradient',\r\n    'textpath': 'textPath'\r\n};\r\n\r\n//Tags that causes exit from foreign content\r\nvar EXITS_FOREIGN_CONTENT = {};\r\n\r\nEXITS_FOREIGN_CONTENT[$.B] = true;\r\nEXITS_FOREIGN_CONTENT[$.BIG] = true;\r\nEXITS_FOREIGN_CONTENT[$.BLOCKQUOTE] = true;\r\nEXITS_FOREIGN_CONTENT[$.BODY] = true;\r\nEXITS_FOREIGN_CONTENT[$.BR] = true;\r\nEXITS_FOREIGN_CONTENT[$.CENTER] = true;\r\nEXITS_FOREIGN_CONTENT[$.CODE] = true;\r\nEXITS_FOREIGN_CONTENT[$.DD] = true;\r\nEXITS_FOREIGN_CONTENT[$.DIV] = true;\r\nEXITS_FOREIGN_CONTENT[$.DL] = true;\r\nEXITS_FOREIGN_CONTENT[$.DT] = true;\r\nEXITS_FOREIGN_CONTENT[$.EM] = true;\r\nEXITS_FOREIGN_CONTENT[$.EMBED] = true;\r\nEXITS_FOREIGN_CONTENT[$.H1] = true;\r\nEXITS_FOREIGN_CONTENT[$.H2] = true;\r\nEXITS_FOREIGN_CONTENT[$.H3] = true;\r\nEXITS_FOREIGN_CONTENT[$.H4] = true;\r\nEXITS_FOREIGN_CONTENT[$.H5] = true;\r\nEXITS_FOREIGN_CONTENT[$.H6] = true;\r\nEXITS_FOREIGN_CONTENT[$.HEAD] = true;\r\nEXITS_FOREIGN_CONTENT[$.HR] = true;\r\nEXITS_FOREIGN_CONTENT[$.I] = true;\r\nEXITS_FOREIGN_CONTENT[$.IMG] = true;\r\nEXITS_FOREIGN_CONTENT[$.LI] = true;\r\nEXITS_FOREIGN_CONTENT[$.LISTING] = true;\r\nEXITS_FOREIGN_CONTENT[$.MENU] = true;\r\nEXITS_FOREIGN_CONTENT[$.META] = true;\r\nEXITS_FOREIGN_CONTENT[$.NOBR] = true;\r\nEXITS_FOREIGN_CONTENT[$.OL] = true;\r\nEXITS_FOREIGN_CONTENT[$.P] = true;\r\nEXITS_FOREIGN_CONTENT[$.PRE] = true;\r\nEXITS_FOREIGN_CONTENT[$.RUBY] = true;\r\nEXITS_FOREIGN_CONTENT[$.S] = true;\r\nEXITS_FOREIGN_CONTENT[$.SMALL] = true;\r\nEXITS_FOREIGN_CONTENT[$.SPAN] = true;\r\nEXITS_FOREIGN_CONTENT[$.STRONG] = true;\r\nEXITS_FOREIGN_CONTENT[$.STRIKE] = true;\r\nEXITS_FOREIGN_CONTENT[$.SUB] = true;\r\nEXITS_FOREIGN_CONTENT[$.SUP] = true;\r\nEXITS_FOREIGN_CONTENT[$.TABLE] = true;\r\nEXITS_FOREIGN_CONTENT[$.TT] = true;\r\nEXITS_FOREIGN_CONTENT[$.U] = true;\r\nEXITS_FOREIGN_CONTENT[$.UL] = true;\r\nEXITS_FOREIGN_CONTENT[$.VAR] = true;\r\n\r\n//Check exit from foreign content\r\nexports.causesExit = function (startTagToken) {\r\n    var tn = startTagToken.tagName;\r\n\r\n    if (tn === $.FONT && (Tokenizer.getTokenAttr(startTagToken, ATTRS.COLOR) !== null ||\r\n        Tokenizer.getTokenAttr(startTagToken, ATTRS.SIZE) !== null ||\r\n        Tokenizer.getTokenAttr(startTagToken, ATTRS.FACE) !== null)) {\r\n        return true;\r\n    }\r\n\r\n    return EXITS_FOREIGN_CONTENT[tn];\r\n};\r\n\r\n//Token adjustments\r\nexports.adjustTokenMathMLAttrs = function (token) {\r\n    for (var i = 0; i < token.attrs.length; i++) {\r\n        if (token.attrs[i].name === DEFINITION_URL_ATTR) {\r\n            token.attrs[i].name = ADJUSTED_DEFINITION_URL_ATTR;\r\n            break;\r\n        }\r\n    }\r\n};\r\n\r\nexports.adjustTokenSVGAttrs = function (token) {\r\n    for (var i = 0; i < token.attrs.length; i++) {\r\n        var adjustedAttrName = SVG_ATTRS_ADJUSTMENT_MAP[token.attrs[i].name];\r\n\r\n        if (adjustedAttrName)\r\n            token.attrs[i].name = adjustedAttrName;\r\n    }\r\n};\r\n\r\nexports.adjustTokenXMLAttrs = function (token) {\r\n    for (var i = 0; i < token.attrs.length; i++) {\r\n        var adjustedAttrEntry = XML_ATTRS_ADJUSTMENT_MAP[token.attrs[i].name];\r\n\r\n        if (adjustedAttrEntry) {\r\n            token.attrs[i].prefix = adjustedAttrEntry.prefix;\r\n            token.attrs[i].name = adjustedAttrEntry.name;\r\n            token.attrs[i].namespace = adjustedAttrEntry.namespace;\r\n        }\r\n    }\r\n};\r\n\r\nexports.adjustTokenSVGTagName = function (token) {\r\n    var adjustedTagName = SVG_TAG_NAMES_ADJUSTMENT_MAP[token.tagName];\r\n\r\n    if (adjustedTagName)\r\n        token.tagName = adjustedTagName;\r\n};\r\n\r\n//Integration points\r\nexports.isMathMLTextIntegrationPoint = function (tn, ns) {\r\n    return ns === NS.MATHML && (tn === $.MI || tn === $.MO || tn === $.MN || tn === $.MS || tn === $.MTEXT);\r\n};\r\n\r\nexports.isHtmlIntegrationPoint = function (tn, ns, attrs) {\r\n    if (ns === NS.MATHML && tn === $.ANNOTATION_XML) {\r\n        for (var i = 0; i < attrs.length; i++) {\r\n            if (attrs[i].name === ATTRS.ENCODING) {\r\n                var value = attrs[i].value.toLowerCase();\r\n\r\n                return value === MIME_TYPES.TEXT_HTML || value === MIME_TYPES.APPLICATION_XML;\r\n            }\r\n        }\r\n    }\r\n\r\n    return ns === NS.SVG && (tn === $.FOREIGN_OBJECT || tn === $.DESC || tn === $.TITLE);\r\n};\r\n"]},"metadata":{},"sourceType":"script"}