{"ast":null,"code":"'use strict';\n\nvar Tokenizer = require('../tokenization/tokenizer'),\n    TokenizerProxy = require('./tokenizer_proxy'),\n    Utils = require('../common/utils'); //Default options\n\n\nvar DEFAULT_OPTIONS = {\n  decodeHtmlEntities: true,\n  locationInfo: false\n}; //Skipping handler\n\nfunction skip() {//NOTE: do nothing =)\n} //SimpleApiParser\n\n\nvar SimpleApiParser = module.exports = function (handlers, options) {\n  this.options = Utils.mergeOptions(DEFAULT_OPTIONS, options);\n  this.handlers = {\n    doctype: this._wrapHandler(handlers.doctype),\n    startTag: this._wrapHandler(handlers.startTag),\n    endTag: this._wrapHandler(handlers.endTag),\n    text: this._wrapHandler(handlers.text),\n    comment: this._wrapHandler(handlers.comment)\n  };\n};\n\nSimpleApiParser.prototype._wrapHandler = function (handler) {\n  var parser = this;\n  handler = handler || skip;\n\n  if (this.options.locationInfo) {\n    return function () {\n      var args = Array.prototype.slice.call(arguments);\n      args.push(parser.currentTokenLocation);\n      handler.apply(handler, args);\n    };\n  }\n\n  return handler;\n}; //API\n\n\nSimpleApiParser.prototype.parse = function (html) {\n  var token = null;\n\n  this._reset(html);\n\n  do {\n    token = this.tokenizerProxy.getNextToken();\n\n    if (token.type === Tokenizer.CHARACTER_TOKEN || token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN || token.type === Tokenizer.NULL_CHARACTER_TOKEN) {\n      if (this.options.locationInfo) {\n        if (this.pendingText === null) this.currentTokenLocation = token.location;else this.currentTokenLocation.end = token.location.end;\n      }\n\n      this.pendingText = (this.pendingText || '') + token.chars;\n    } else {\n      this._emitPendingText();\n\n      this._handleToken(token);\n    }\n  } while (token.type !== Tokenizer.EOF_TOKEN);\n}; //Internals\n\n\nSimpleApiParser.prototype._handleToken = function (token) {\n  if (this.options.locationInfo) this.currentTokenLocation = token.location;\n  if (token.type === Tokenizer.START_TAG_TOKEN) this.handlers.startTag(token.tagName, token.attrs, token.selfClosing);else if (token.type === Tokenizer.END_TAG_TOKEN) this.handlers.endTag(token.tagName);else if (token.type === Tokenizer.COMMENT_TOKEN) this.handlers.comment(token.data);else if (token.type === Tokenizer.DOCTYPE_TOKEN) this.handlers.doctype(token.name, token.publicId, token.systemId);\n};\n\nSimpleApiParser.prototype._reset = function (html) {\n  this.tokenizerProxy = new TokenizerProxy(html, this.options);\n  this.pendingText = null;\n  this.currentTokenLocation = null;\n};\n\nSimpleApiParser.prototype._emitPendingText = function () {\n  if (this.pendingText !== null) {\n    this.handlers.text(this.pendingText);\n    this.pendingText = null;\n  }\n};","map":{"version":3,"sources":["F:/JavaScript/Projects/chemistryphile/node_modules/jsdom-no-contextify/node_modules/parse5/lib/simple_api/simple_api_parser.js"],"names":["Tokenizer","require","TokenizerProxy","Utils","DEFAULT_OPTIONS","decodeHtmlEntities","locationInfo","skip","SimpleApiParser","module","exports","handlers","options","mergeOptions","doctype","_wrapHandler","startTag","endTag","text","comment","prototype","handler","parser","args","Array","slice","call","arguments","push","currentTokenLocation","apply","parse","html","token","_reset","tokenizerProxy","getNextToken","type","CHARACTER_TOKEN","WHITESPACE_CHARACTER_TOKEN","NULL_CHARACTER_TOKEN","pendingText","location","end","chars","_emitPendingText","_handleToken","EOF_TOKEN","START_TAG_TOKEN","tagName","attrs","selfClosing","END_TAG_TOKEN","COMMENT_TOKEN","data","DOCTYPE_TOKEN","name","publicId","systemId"],"mappings":"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","sourcesContent":["'use strict';\r\n\r\nvar Tokenizer = require('../tokenization/tokenizer'),\r\n    TokenizerProxy = require('./tokenizer_proxy'),\r\n    Utils = require('../common/utils');\r\n\r\n//Default options\r\nvar DEFAULT_OPTIONS = {\r\n    decodeHtmlEntities: true,\r\n    locationInfo: false\r\n};\r\n\r\n//Skipping handler\r\nfunction skip() {\r\n    //NOTE: do nothing =)\r\n}\r\n\r\n//SimpleApiParser\r\nvar SimpleApiParser = module.exports = function (handlers, options) {\r\n    this.options = Utils.mergeOptions(DEFAULT_OPTIONS, options);\r\n    this.handlers = {\r\n        doctype: this._wrapHandler(handlers.doctype),\r\n        startTag: this._wrapHandler(handlers.startTag),\r\n        endTag: this._wrapHandler(handlers.endTag),\r\n        text: this._wrapHandler(handlers.text),\r\n        comment: this._wrapHandler(handlers.comment)\r\n    };\r\n};\r\n\r\nSimpleApiParser.prototype._wrapHandler = function (handler) {\r\n    var parser = this;\r\n\r\n    handler = handler || skip;\r\n\r\n    if (this.options.locationInfo) {\r\n        return function () {\r\n            var args = Array.prototype.slice.call(arguments);\r\n            args.push(parser.currentTokenLocation);\r\n            handler.apply(handler, args);\r\n        };\r\n    }\r\n\r\n    return handler;\r\n};\r\n\r\n//API\r\nSimpleApiParser.prototype.parse = function (html) {\r\n    var token = null;\r\n\r\n    this._reset(html);\r\n\r\n    do {\r\n        token = this.tokenizerProxy.getNextToken();\r\n\r\n        if (token.type === Tokenizer.CHARACTER_TOKEN ||\r\n            token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN ||\r\n            token.type === Tokenizer.NULL_CHARACTER_TOKEN) {\r\n\r\n            if (this.options.locationInfo) {\r\n                if (this.pendingText === null)\r\n                    this.currentTokenLocation = token.location;\r\n\r\n                else\r\n                    this.currentTokenLocation.end = token.location.end;\r\n            }\r\n\r\n            this.pendingText = (this.pendingText || '') + token.chars;\r\n        }\r\n\r\n        else {\r\n            this._emitPendingText();\r\n            this._handleToken(token);\r\n        }\r\n    } while (token.type !== Tokenizer.EOF_TOKEN);\r\n};\r\n\r\n//Internals\r\nSimpleApiParser.prototype._handleToken = function (token) {\r\n    if (this.options.locationInfo)\r\n        this.currentTokenLocation = token.location;\r\n\r\n    if (token.type === Tokenizer.START_TAG_TOKEN)\r\n        this.handlers.startTag(token.tagName, token.attrs, token.selfClosing);\r\n\r\n    else if (token.type === Tokenizer.END_TAG_TOKEN)\r\n        this.handlers.endTag(token.tagName);\r\n\r\n    else if (token.type === Tokenizer.COMMENT_TOKEN)\r\n        this.handlers.comment(token.data);\r\n\r\n    else if (token.type === Tokenizer.DOCTYPE_TOKEN)\r\n        this.handlers.doctype(token.name, token.publicId, token.systemId);\r\n\r\n};\r\n\r\nSimpleApiParser.prototype._reset = function (html) {\r\n    this.tokenizerProxy = new TokenizerProxy(html, this.options);\r\n    this.pendingText = null;\r\n    this.currentTokenLocation = null;\r\n};\r\n\r\nSimpleApiParser.prototype._emitPendingText = function () {\r\n    if (this.pendingText !== null) {\r\n        this.handlers.text(this.pendingText);\r\n        this.pendingText = null;\r\n    }\r\n};\r\n"]},"metadata":{},"sourceType":"script"}